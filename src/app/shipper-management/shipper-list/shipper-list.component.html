<div class="site-loader" *ngIf="showLoader">
  <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
</div>

    <div class="CAmobile_view Container_scroll">
      <div class="page-header">
        <div class="float-left">
          <h3>Shipper Management</h3>
          <p>A place to manage all of the Shipper on the LaneAxis system.</p>
        </div>
        <div class="float-end">
          <button class="btn custum_button button_primary">
            <!-- (click)="clickEvent()" -->
            <span class="mat-button-wrapper">Create New</span>
            <span matripple="" class="mat-ripple mat-button-ripple"></span>
            <span class="mat-button-focus-overlay"></span>
          </button>
        </div>
      </div>
      <div class="filter_section" [ngClass]="status ? 'filter_show' : 'filter_hide'">
        <div class="section-head">
          <div class="float-left">
            <h3>All Shippers ({{totalRecords}})</h3>
          </div>
          <div class="float-end" [ngClass]="filterActivated ? 'active_filter' : ''">
            <button class="mat-focus-indicator mat-flat-button mat-button-base dot_circle" (click)="filterToggleEvent()">
              <span class="mat-button-wrapper">Filter</span>
            </button>
            <!-- <div class="custom_search float-end">
              <form [formGroup]="searchForm">
              <mat-form-field appearance="fill">
                <input matInput #first placeholder="Search" formControlName="searchInput">
                <mat-icon matSuffix classs="fs_18" (click)="applyFilter()">
                  <span class="icon icon-ic-search fs_18"></span>
                </mat-icon>
              </mat-form-field>
            </form>
            </div> -->
            <span class="circle_download ms-3">
              <span class="icon-ic-download fs_20"></span>
            </span>
          </div>
        </div>
        <div class="mob-section-head">
          <div class="filter_btn active_filter">
            <div class="custom_search m-0">
              <mat-form-field appearance="fill">
                <mat-icon matPrefix class="pe-2">
                  <span class="icon icon-ic-search fs_18"></span>
                </mat-icon>
                <input matInput #first placeholder="Search by Company" class="ms-2">
              </mat-form-field>
            </div>
            <div class="active_filter" style="position: relative;">
              <span class="icon-ic-filter fs_24 txt_lb px-2 py-1 dot_circle" (click)="filterToggleEvent()"></span>
            </div>
          </div>
          <div>
            <h3 class="fs_16 txt_b fsm_5" style="padding: 0 15px; margin: 30px 0 0;">All Shippers</h3>
          </div>
        </div>

        <div class="show-filter">
          <form class="example-form filter_selection" [formGroup]="filterForm">
            <div class="row">
              <!-- <div class="col-md-12">
                <p class="fs_16 txt_b fsm_5 my-3">Searched by Freely</p>
              </div> -->
              <div class="col-md-12">
                <div class="custom_checkbox filter_head">
                  <p class="fs_16 txt_b fsb_7 mb-3">Filter</p>
                  <mat-checkbox class="example-margin" formControlName="isRegisteredUser"><span class="ms-1"> Show Only Registered Users</span></mat-checkbox>
                </div>
              </div>
              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>Search</mat-label>
                  <input matInput placeholder="Search" type="text" formControlName="search">
                </mat-form-field>
              </div>

              <div class="col-md-3 mb-2"></div>
              <div class="col-md-3 mb-2"></div>
              <div class="col-md-3 mb-2"></div>
              
              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>Search Address</mat-label>
                  <input matInput placeholder="Enter Search Address" type="text" formControlName="searchAddress">
                  <!-- <mat-hint>Search by Address</mat-hint> -->
                </mat-form-field>
              </div>
              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>City</mat-label>
                  <input matInput  type="text" formControlName="city">
                </mat-form-field>
              </div>
              
              
              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>State</mat-label>
                  <mat-select formControlName="state">
                    <mat-option *ngFor="let eValue of statesList" value="{{eValue.key}}">{{eValue.value}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-md-3 mb-2"></div>
              
              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>Equipment Types</mat-label>
                  <mat-select multiple formControlName="equipmentType">
                    <mat-option *ngFor="let eValue of equipmentTypes" value="{{eValue.key}}">{{eValue.value}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>Min Revenue</mat-label>
                  <input matInput placeholder="Enter Min Revenue" type="number" formControlName="minRevenue">					   
                </mat-form-field>
              </div>

              <div class="col-md-3 mb-2">
                <mat-form-field class="w-100">
                  <mat-label>Max Revenue</mat-label>
                  <input matInput placeholder="Enter Max Revenue" type="number" formControlName="maxRevenue">
               </mat-form-field>
               <small class="txt_d" *ngIf="revenueValidationFailed">Minimum required revenue is {{filterForm.get('minRevenue').value}}</small>
              </div>


              <!-- <div class="col-md-3 mb-2"></div> -->
              <div class="col-md-3 mb-2">
                <div class="date-picker-with-icon">
                  <mat-form-field class="w-100">
                    <mat-label>Updated At</mat-label>
                    <input matInput type="text" ngxDaterangepickerMd startKey="start" endKey="end" [ranges]="ranges" [readonly]="true" formControlName="updatedAt" [alwaysShowCalendars]="true" [closeOnAutoApply]="true" [showClearButton]="true" [locale]="{ cancelLabel: 'Cancel', applyLabel: 'ok', format: 'DD-MM-YYYY'}"  drops="down" opens="right" autocomplete="off" [maxDate]="todayDate">
                  </mat-form-field>
                </div>
              </div>
              
              
              <div class="col-md-3 mb-2">
                <div class="date-picker-with-icon">
                <mat-form-field class="w-100">
                  <mat-label>Created At</mat-label>
                  <input matInput type="text" ngxDaterangepickerMd startKey="start" endKey="end" [ranges]="ranges" [readonly]="true" formControlName="createdAt" [alwaysShowCalendars]="true" [closeOnAutoApply]="true" [showClearButton]="true" [locale]="{ cancelLabel: 'Cancel', applyLabel: 'ok', format: 'DD-MM-YYYY'}"  drops="down" opens="right" autocomplete="off" [maxDate]="todayDate">
                </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 mb-2">
                <div class="date-picker-with-icon">
                <mat-form-field class="w-100">
                  <mat-label>Registration Date</mat-label>
                  <input matInput type="text" ngxDaterangepickerMd startKey="start" endKey="end" [ranges]="ranges" [readonly]="true" formControlName="registrationDate" [alwaysShowCalendars]="true" [closeOnAutoApply]="true" [showClearButton]="true" [locale]="{ cancelLabel: 'Cancel', applyLabel: 'ok', format: 'DD-MM-YYYY'}"  drops="down" opens="right" autocomplete="off" [maxDate]="todayDate">
                </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 mb-2">
                <div class="date-picker-with-icon">
                <mat-form-field class="w-100">
                  <mat-label>Last Login</mat-label>
                  <input matInput type="text" ngxDaterangepickerMd startKey="start" endKey="end" [ranges]="ranges" [readonly]="true" formControlName="lastLogin" [alwaysShowCalendars]="true" [closeOnAutoApply]="true" [showClearButton]="true" [locale]="{ cancelLabel: 'Cancel', applyLabel: 'ok', format: 'DD-MM-YYYY'}"  drops="down" opens="left" autocomplete="off" [maxDate]="todayDate">
                </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 mb-2">
                <div class="date-picker-with-icon">
                <mat-form-field class="w-100">
                  <mat-label>First Login</mat-label>
                  <input matInput type="text" ngxDaterangepickerMd startKey="start" endKey="end" [ranges]="ranges" [readonly]="true" formControlName="firstLogin" [alwaysShowCalendars]="true" [closeOnAutoApply]="true" [showClearButton]="true" [locale]="{ cancelLabel: 'Cancel', applyLabel: 'ok', format: 'DD-MM-YYYY'}"  drops="down" opens="left" autocomplete="off" [maxDate]="todayDate">
                </mat-form-field>
                </div>
              </div>

              <div class="col-md-3 mb-2">
                <div class="cus_toggle_bg custom_toggle">
                  <mat-slide-toggle class="float-end" formControlName="emailVerified"><span class="txt_lb ms-3">Email Verify ({{filterForm.get('emailVerified').value == true ? 'Yes' : 'No'}})</span> </mat-slide-toggle>
                </div>
              </div>
              <div class="col-md-3 mb-2">
                <div class="cus_toggle_bg custom_toggle">
                  <mat-slide-toggle class="float-end" formControlName="phoneVerified"><span class="txt_lb ms-3">Phone Verify ({{filterForm.get('phoneVerified').value == true ? 'Yes' : 'No'}})</span> </mat-slide-toggle>
                </div>
              </div>
              
              <div class="col-md-12 text-end">
                <a class="pointer me-3" style="border-radius: 30px; padding: 2px 20px;" (click)="status=false;resetData()">Reset</a>
                <button class="btn custum_button button_primary bg_s" (click)="updateSearchResults()">
                  <span class="mat-button-wrapper">Update Results</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="user_table" (scroll)="onTableScroll($event)">
        <table mat-table class="all-carriers" [dataSource]="dataSource" style="width: 100%;">
          <!-- Name Column -->
          <ng-container matColumnDef="companyName">
            <th mat-header-cell *matHeaderCellDef> Name </th>
            <td mat-cell *matCellDef="let element">
              <div class="carrier-avtar" (click)="redirectToShipperView(element)"> 
                <span class="carrier_image">
                  <span class="short_name" *ngIf="(!element.profileImage || element.profileImage == '')">{{getInitials(element.companyName)}}</span>
                  <img *ngIf="(element.profileImage && element.profileImage!='')" src="{{element.profileImage}}"/>
                </span>
                <div class="carrier_info">
                  <p class="carrier_name text_truncate" matTooltip="{{element.companyName}}">{{element.companyName}}</p>
                  <span>
                    <span class="carrier_location text_truncate" matTooltip="{{element.phyStreet}}, {{element.phyCity}}, {{element.phyState}}">{{element.phyCity ? element.phyCity : '-'}}, {{element.phyState ? element.phyState : '-'}}</span>
                    <span class="fs_12 fsm_5 txt_b mb-0 ms-2 ope_5" matTooltip="Revenue">400M</span>
                  </span>
                  <div class="verify_status">
                    <span class="material-icons fs_14" [ngClass]="element.userId ? 'txt_s' : 'txt_d'" matTooltip="{{element.userId ? 'User is Registered' : 'User is not Registered'}}">how_to_reg</span>
                    <span class="material-icons fs_14 " [ngClass]="element.emailVerified ? 'txt_s' : 'txt_d'" matTooltip="{{element.emailVerified ? 'Email is Verified' : 'Email is not Verified'}}">email</span>
                    <span class="material-icons fs_14" [ngClass]="element.phoneVerified ? 'txt_s' : 'txt_d'" matTooltip="{{element.phoneVerified ? 'Phone is Verified' : 'Phone is not Verified'}}">call</span>
                  </div>
                </div>
             </div>
           </td>
          </ng-container>
        
          <!-- Weight Column -->
          <!-- <ng-container matColumnDef="dotNumber">
            <th mat-header-cell *matHeaderCellDef class="px-2"> DOT Number </th>
            <td mat-cell *matCellDef="let element" class="px-2"> {{element.dotNumber}} </td>
          </ng-container> -->
        
          <!-- Symbol Column -->
          <ng-container matColumnDef="equipmentType">
            <th mat-header-cell *matHeaderCellDef class="px-2"> Equipment Type </th>
            <td mat-cell *matCellDef="let element" class="px-2" matTooltip="{{element.equipmentType ? (element.equipmentType.join(' | ')) : '-'}}" style="max-width: 180px;">
             <span class="eq_type max_lineTwo">{{element.equipmentType ? (element.equipmentType.join(' | ')) : '-'}}</span></td>
          </ng-container>

           <!-- Symbol Column -->
          <ng-container matColumnDef="industryType">
            <th mat-header-cell *matHeaderCellDef class="px-2"> Industry Type </th>
            <td mat-cell *matCellDef="let element" class="px-2"> {{element.industries}} {{element.industries ? ' | ' : ''}} {{element.usSic1987Description ? element.usSic1987Description : '-'}} </td>
          </ng-container>

          <!-- Symbol Column -->
          <ng-container matColumnDef="emailAddress">
            <th mat-header-cell *matHeaderCellDef class="px-2"> Email Address </th>
            <td mat-cell *matCellDef="let element" class="px-2" style="max-width: 150px;">
              <div class="email_col">
                <span class="txt_p max_lineTwo" matTooltip="{{element.email}}">{{element.email}}</span>
              </div>
            </td>
          </ng-container>

          <!-- Symbol Column -->
          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef class="px-2"> Registration Date </th>
            <td mat-cell *matCellDef="let element" class="px-2"> {{element.registrationDate ? (element.registrationDate | date:'MMM d, y, h:mm a') : '-'}} </td>
          </ng-container>

          <!-- Symbol Column -->
          <ng-container matColumnDef="connected">
            <th mat-header-cell *matHeaderCellDef class="px-2"> Connected </th>
            <td mat-cell *matCellDef="let element" class="px-2"> {{(element.connected || element.connected==0) ? element.connected : '-'}}</td>
          </ng-container>

           <!-- Symbol Column -->
          <ng-container matColumnDef="invitation">
            <th mat-header-cell *matHeaderCellDef class="px-2">Invited</th>
            <td mat-cell *matCellDef="let element" class="px-2">{{ (element.invitation || element.invitation==0) ? element.invitation : '-'}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" style="background: #eef0f4;"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" style="background: #fff;"></tr>
        </table>

        <ng-container *ngIf="dataSource && dataSource.length == 0">
          <div class="data_notFound">No Data Found.</div>
        </ng-container>
         <div class="spinner_loader" *ngIf="apiCallInProcess">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
          </div>
      </div>
    </div><!-- End of page-main-content -->
